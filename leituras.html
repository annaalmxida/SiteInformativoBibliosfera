<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Leituras - Bibliosfera</title>

	<!-- Fontes (devem carregar antes do CSS) -->
	<link href="https://fonts.googleapis.com/css2?family=Sour+Gummy:wght@300;400;600;700&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Comic+Relief:wght@400;700&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

	<!-- CSS principal -->
	<link rel="stylesheet" href="home.css">
	<link rel="shortcut icon" href="img/logo.png">
	<script src="script.js"></script>
</head>
<body id="topo">

	<header>
		<div class="dvh">
			<a href="home.html" class="topo" title="Ir para o início" aria-label="Ir para o início da página">
				<img src="img/logo.png" alt="Logo da Bibliosfera" class="logo" />
				<h1 class="tituloh">Bibliosfera</h1>
			</a>
		</div>

		<nav class="nav">
			<ul class="navlinks">
				<li><a href="resenhas.html">Resenhas</a></li>
				<li><a href="videos.html">Vídeos</a></li>
				<li><a href="leituras.html">Leituras</a></li>
				<li><a href="blog.html">Blog</a></li>
				<li><a href="comunidade.html">Comunidade</a></li>
				<li><a href="perfil.php">Meu Perfil</a></li>
				<li><a href="contato.html">Contato</a></li>
				<li class="nav-login">
					<a href="logout.php"
						class="btn-entrar"
						id="btnEntrar"
						type="button"
						title="Entrar"
						aria-haspopup="dialog"
						aria-controls="loginModal"
						aria-label="Entrar">
						<img src="https://img.icons8.com/ios-filled/50/ff9800/login-rounded-right.png" alt="Entrar">
						<span class="btn-text">Sair</span>
					</a>
				</li>
			</ul>
		</nav>
	</header>

	<main class="home">

		<!-- HERO LEITURAS -->
		<section class="hero">
			<div class="hero-text">
				<h2>Meu Progresso de Leitura</h2>
				<p>
					Acompanhe seus livros em andamento, registre seu progresso
					e compartilhe atualizações com a comunidade.
				</p>

				<div class="hero-actions">
					<button id="add-book-btn" class="btn-primary" role="button" aria-label="Adicionar Novo Livro">Adicionar Livro</button>
					<a href="comunidade.html" class="btn-secondary" role="button" aria-label="Ver Comunidade">Ver Comunidade</a>
				</div>
			</div>

			<div class="hero-image">
				<img src="img/ler.webp" alt="Ilustração de leitura">
			</div>
		</section>

		<!-- FORMULÁRIO PARA ADICIONAR LIVRO (OCULTO POR PADRÃO) -->
		<section id="add-book-form" class="section" style="display: none;">
			<h3>Adicionar Novo Livro</h3>
			<form id="book-form">
				<label for="book-title">Título do Livro:</label>
				<input type="text" id="book-title" required>

				<label for="book-author">Autor:</label>
				<input type="text" id="book-author" required>

				<label for="total-pages">Total de Páginas:</label>
				<input type="number" id="total-pages" required>

				<button type="submit" class="btn-primary">Adicionar Livro</button>
			</form>
		</section>

		<!-- LIVROS EM PROGRESSO -->
		<section class="section" id="progress-section">
			<h3>Meus Livros em Andamento</h3>
			<div id="books-container" class="cards">
				<!-- Livros serão inseridos aqui via JS -->
			</div>
		</section>

		<!-- CTA FINAL -->
		<section class="cta">
			<h3>Compartilhe Seu Progresso</h3>
			<p>
				Suas atualizações aparecem no seu perfil e na comunidade,
				inspirando outros leitores.
			</p>
			<a href="perfil.php" class="btn-primary">Ver Meu Perfil</a>
		</section>

	</main>

	<!-- Footer padronizado -->
	<footer style="width: 100%; background-color: #0f55b2; padding: 25px 0; margin-top: auto; display: block; box-shadow: 0 -2px 10px #0f55b2;">
		<div style="max-width: 1200px; margin: 0 auto; padding: 0 50px; display: flex; justify-content: center; align-items: center; position: relative; box-sizing: border-box;">
			
			<span style="color: #ffffff; font-family: 'Sour Gummy', cursive; font-size: 18px; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">
				© 2026 - Todos os direitos reservados
			</span>

			<a href="#topo" style="position: absolute; right: 50px; border: 2px solid #ffffff; color: #ffffff; text-decoration: none; padding: 8px 18px; border-radius: 12px; font-family: 'Sour Gummy', cursive; font-weight: 600; font-size: 16px; transition: 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
				Voltar ao topo
			</a>
			
		</div>
	</footer>

	<script>
document.addEventListener('DOMContentLoaded', function() {
    const addBookBtn = document.getElementById('add-book-btn');
    const addBookForm = document.getElementById('add-book-form');
    const bookForm = document.getElementById('book-form');
    const booksContainer = document.getElementById('books-container');

    // Toggle form
    addBookBtn.addEventListener('click', () => {
        addBookForm.style.display = addBookForm.style.display === 'none' ? 'block' : 'none';
    });

    // Add book
    bookForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const title = document.getElementById('book-title').value;
        const author = document.getElementById('book-author').value;
        const totalPages = parseInt(document.getElementById('total-pages').value);

        const book = {
            id: Date.now(),
            title,
            author,
            totalPages,
            currentPage: 0,
            updates: []
        };

        saveBook(book);
        renderBooks();
        bookForm.reset();
        addBookForm.style.display = 'none';
    });

    // Render books
    function renderBooks() {
        const books = getBooks();
        booksContainer.innerHTML = '';
        books.forEach(book => {
            const progressPercent = (book.currentPage / book.totalPages) * 100;
            const card = document.createElement('article');
            card.className = 'progress-card';
            card.innerHTML = `
                <h4>${book.title}</h4>
                <p>Por ${book.author}</p>
                <p>Páginas: ${book.currentPage}/${book.totalPages}</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progressPercent}%"></div>
                </div>
                <button class="update-btn" data-id="${book.id}">Atualizar Progresso</button>
            `;
            booksContainer.appendChild(card);
        });

        // Add event listeners to update buttons
        document.querySelectorAll('.update-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const bookId = parseInt(e.target.dataset.id);
                showUpdateModal(bookId);
            });
        });
    }

    // Show update modal
    function showUpdateModal(bookId) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
            <div class="modal-content">
                <h3>Atualizar Progresso</h3>
                <label for="current-page">Páginas Lidas:</label>
                <input type="number" id="current-page" min="0">
                <label for="comment">Comentário (opcional):</label>
                <textarea id="comment" rows="3"></textarea>
                <div class="modal-actions">
                    <button id="cancel-btn">Cancelar</button>
                    <button id="save-btn" class="btn-primary">Salvar</button>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
        modal.style.display = 'flex';

        const book = getBooks().find(b => b.id === bookId);
        document.getElementById('current-page').value = book.currentPage;

        document.getElementById('cancel-btn').addEventListener('click', () => {
            modal.remove();
        });

        document.getElementById('save-btn').addEventListener('click', () => {
            const currentPage = parseInt(document.getElementById('current-page').value);
            const comment = document.getElementById('comment').value;

            updateBookProgress(bookId, currentPage, comment);
            modal.remove();
            renderBooks();
        });
    }

    // LocalStorage functions
    function getBooks() {
        return JSON.parse(localStorage.getItem('readingBooks') || '[]');
    }

    function saveBook(book) {
        const books = getBooks();
        books.push(book);
        localStorage.setItem('readingBooks', JSON.stringify(books));
    }

    function updateBookProgress(bookId, currentPage, comment) {
        const books = getBooks();
        const bookIndex = books.findIndex(b => b.id === bookId);
        if (bookIndex !== -1) {
            books[bookIndex].currentPage = currentPage;
            if (comment) {
                const update = {
                    date: new Date().toISOString(),
                    pages: currentPage,
                    comment
                };
                books[bookIndex].updates.push(update);
                // Save to global updates for community
                saveGlobalUpdate(update, books[bookIndex]);
            }
            localStorage.setItem('readingBooks', JSON.stringify(books));
        }
    }

    function saveGlobalUpdate(update, book) {
        const globalUpdates = JSON.parse(localStorage.getItem('globalUpdates') || '[]');
        globalUpdates.unshift({
            ...update,
            bookTitle: book.title,
            bookAuthor: book.author
        });
        localStorage.setItem('globalUpdates', JSON.stringify(globalUpdates));
    }

    // Initial render
    renderBooks();
});
</script>

</body>
</html>
